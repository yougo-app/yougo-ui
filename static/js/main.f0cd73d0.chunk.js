(this["webpackJsonpyougo-ui"]=this["webpackJsonpyougo-ui"]||[]).push([[0],{443:function(e,t,n){"use strict";n.r(t);n(267),n(268);var c=n(48),a=n(10),r=n.n(a),i=function(e){var t=e.fallback,n=e.children;return Object(c.b)().isAuthenticated?n:t};i.propTypes={fallback:r.a.node,children:r.a.node.isRequired},i.defaultProps={fallback:null};var o=i,s=n(491),l=n(515),u=n(518),j=n(16),b=n(13),d=n(232),O=n.n(d),h=n(516),f=n(517),x=n(128),v=n(507),g=n(484),p=n(485),m=n(506),C=n(497),S=n(0),y=n(1),k=Object(S.createContext)(""),_=Object(S.createContext)(""),A=function(e){var t=e.children,n=Object(S.useState)(""),c=Object(b.a)(n,2),a=c[0],r=c[1];return Object(y.jsx)(k.Provider,{value:a,children:Object(y.jsx)(_.Provider,{value:r,children:t})})};function P(){var e=Object(S.useContext)(k);if(void 0===e)throw new Error("useSearch must be used within a SearchContext");return e}function w(){var e=Object(S.useContext)(_);if(void 0===e)throw new Error("useSearch must be used within a SearchContext");return e}var T=function(e){var t=e.cancelOnEscape,n=[P(),w()],c=Object(b.a)(n,2),a=c[0],r=c[1],i=Object(S.useCallback)((function(e){return r(e.target.value)}),[r]),o=Object(S.useCallback)((function(){return r("")}),[r]),s=Object(S.useCallback)((function(e){!t||27!==e.charCode&&"Escape"!==e.key||o()}),[t,o]),l=Object(y.jsx)(m.a,{position:"start",children:Object(y.jsx)(g.a,{})}),u=Object(y.jsx)(m.a,{position:"end",children:Object(y.jsx)(v.a,{onClick:o,children:Object(y.jsx)(p.a,{})})}),j=!!a;return Object(y.jsx)(C.a,{fullWidth:!0,margin:"dense",size:"small",value:a,onChange:i,onKeyUp:s,InputProps:{sx:{bgcolor:"background.paper"},startAdornment:l,endAdornment:j?u:null}})};T.defaultProps={cancelOnEscape:!0};var E=T,R=n(489),I=n(503),L=n(239),D=n(504),B=n(510),U=n(155),W=n(84),z=function(e){var t=Object(c.b)(),n=t.user,a=t.logout,r=t.loginWithRedirect,i=t.isAuthenticated,o=Object(W.usePopupState)({variant:"popover"}),s=Object(S.useCallback)((function(){o.close(),a()}),[o,a]);return i?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(B.a,Object(j.a)(Object(j.a)(Object(j.a)({color:"inherit"},Object(U.bindTrigger)(o)),e),{},{children:[Object(y.jsx)(I.a,{sx:{width:48,height:48},imgProps:{referrerPolicy:"no-referrer"},src:n.picture}),Object(y.jsx)(R.a,{})]})),Object(y.jsxs)(L.a,Object(j.a)(Object(j.a)({anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},Object(U.bindMenu)(o)),{},{children:[Object(y.jsx)(D.a,{onClick:o.close,children:"Profile"}),Object(y.jsx)(D.a,{onClick:o.close,children:"My account"}),Object(y.jsx)(D.a,{onClick:s,children:"Logout"})]}))]}):Object(y.jsx)(B.a,{color:"inherit",onClick:r,children:Object(y.jsx)(I.a,{sx:{width:48,height:48}})})},G=n(26),H=n(20),M=n(21),Q=n(224),q=n.n(Q);function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"REACT_APP_",c=n+e;return window.env&&c in window.env?window.env[c]:c in Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OIDC_CLIENT_ID:"VAaM5ckAGBxVjgZDxBFiYuP4zGmS7CBn",REACT_APP_OIDC_AUTHORITY:"yougo.au.auth0.com",REACT_APP_API_URL:"https://yougo-api.herokuapp.com"})?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OIDC_CLIENT_ID:"VAaM5ckAGBxVjgZDxBFiYuP4zGmS7CBn",REACT_APP_OIDC_AUTHORITY:"yougo.au.auth0.com",REACT_APP_API_URL:"https://yougo-api.herokuapp.com"})[c]:t}var F=Y("API_URL","http://localhost:8080"),V=Y("OIDC_AUTHORITY"),K=Y("OIDC_CLIENT_ID"),N=Y("OIDC_REDIRECT_URI",window.location.origin),J=parseInt(Y("CACHE_STALE_TIME","60000"),10),Z=function(){function e(t){var n,c=t.token,a=Object(G.a)(t,["token"]);Object(H.a)(this,e),this.axios=q.a.create(Object(j.a)(Object(j.a)({},a),{},{baseURL:"".concat(null!==(n=a.baseURL)&&void 0!==n?n:F),headers:Object(j.a)({Authorization:"Bearer ".concat(c)},a.headers)}))}return Object(M.a)(e,[{key:"findGoByIdOrAlias",value:function(e){return this.axios.get("/gos/".concat(e)).then((function(e){return e.data}))}},{key:"listGos",value:function(){return this.axios.get("/gos").then((function(e){return e.data}))}},{key:"createGo",value:function(e){return this.axios.post("/gos",e).then((function(e){return e.data}))}},{key:"patchGo",value:function(e,t){return this.axios.patch("/gos/".concat(e),t).then((function(e){return e.data}))}},{key:"deleteGo",value:function(e){return this.axios.delete("/gos/".concat(e)).then((function(e){return e.data}))}}]),e}();function $(){return(0,Object(c.b)().getAccessTokenSilently)().then((function(e){return new Z({token:e})}))}var X=n(27),ee="gos",te="go";function ne(e){var t,n=function(){var e=$();return Object(X.useQuery)([ee],(function(){return e.then((function(e){return e.listGos()}))}))}();return e.length<=2?n:Object(j.a)(Object(j.a)({},n),{},{data:(n.data||[]).filter((t=e,function(e){return Object.values(e).some((function(e){return e.toLowerCase().indexOf(t)>=0}))}))})}var ce=n(121),ae=n.n(ce);var re=n(156),ie=n.n(re),oe=n(225),se=n(17);var le=n(226),ue=n.n(le),je=n(50);var be=n(511),de=n(512),Oe=n(513),he=n(514),fe=n(12),xe=function(e){var t=e.children,n=e.title,c=e.action,a=e.onClose,r=e.onSubmit,i=Object(G.a)(e,["children","title","action","onClose","onSubmit"]);return Object(y.jsxs)(be.a,Object(j.a)(Object(j.a)({open:!0,fullWidth:!0,onClose:a},i),{},{children:[n&&Object(y.jsx)(de.a,{children:n}),Object(y.jsx)(Oe.a,{children:t}),Object(y.jsxs)(he.a,{children:[Object(y.jsx)(B.a,{onClick:a,children:"Cancel"}),Object(y.jsx)(B.a,{color:"secondary",onClick:r,children:Object(fe.a)(c)})]})]}))};xe.defaultProps={action:"Submit",title:void 0};var ve=xe,ge=function(e){var t=e.formik,n=Object(G.a)(e,["formik"]);return Object(y.jsxs)("form",Object(j.a)(Object(j.a)({onSubmit:t.handleSubmit},n),{},{children:[Object(y.jsx)(C.a,{id:"alias",name:"alias",label:"Alias",value:t.values.alias,onChange:t.handleChange,onBlur:t.handleBlur,error:Boolean(t.touched.alias&&t.errors.alias),helperText:t.touched.alias&&t.errors.alias,fullWidth:!0,autoFocus:!0,margin:"dense",variant:"standard"}),Object(y.jsx)(C.a,{id:"href",name:"href",label:"URL",value:t.values.href,onChange:t.handleChange,onBlur:t.handleBlur,error:Boolean(t.touched.href&&t.errors.href),helperText:t.touched.href&&t.errors.href,fullWidth:!0,margin:"dense",variant:"standard"}),Object(y.jsx)(l.a,{hidden:!0,children:Object(y.jsx)("button",{type:"submit",children:"Submit"})})]}))},pe=n(237),me=n(99),Ce=Object(me.a)().shape({id:Object(me.b)(),alias:Object(me.b)().trim().required().matches(/^[\w-]+$/,{excludeEmptyString:!0,message:"Alias cannot contain whitespace"}),href:Object(me.b)().trim().required().url()});r.a.shape({id:r.a.string.isRequired,alias:r.a.string.isRequired,href:r.a.string.isRequired}),r.a.oneOfType([r.a.func,r.a.shape({current:r.a.any})]);function Se(e){return Object(pe.a)(Object(j.a)({initialValues:{alias:"",href:""},validationSchema:Ce,validateOnBlur:!0},e))}var ye=function(e){var t=e.onClose,n=Object(G.a)(e,["onClose"]),c=Object(je.b)().enqueueSnackbar,a=function(){var e=$(),t=Object(X.useQueryClient)();return Object(X.useMutation)((function(t){return e.then((function(e){return e.createGo(t)}))}),{onSuccess:function(){t.invalidateQueries([ee])}})}().mutateAsync,r=Se({onSubmit:Object(S.useCallback)((function(e,n){var r=n.setSubmitting;a(e).catch((function(){return c("Problem creating '".concat(e.alias,"'"),{variant:"error"})})).finally((function(){r(!1),t()}))}),[a,t,c])});return Object(y.jsx)(ve,Object(j.a)(Object(j.a)({title:"Add a go",action:"Add",onClose:t,onSubmit:r.handleSubmit},n),{},{children:Object(y.jsx)(ge,{formik:r})}))},ke=n(82);function _e(){var e=Object(ke.b)((function(){return Object(y.jsx)(ye,{onClose:c})})),t=Object(b.a)(e,2),n=t[0],c=t[1];return[n,c]}function Ae(e){var t=Object(je.b)().enqueueSnackbar,n=function(){var e=$(),t=Object(X.useQueryClient)();return Object(X.useMutation)((function(t){var n=t.id;return e.then((function(e){return e.deleteGo(n)}))}),{onSuccess:function(e,n){var c=n.alias;t.invalidateQueries([ee]),t.removeQueries([te,c])}})}().mutateAsync;return Object(S.useCallback)((function(){var c=Object(y.jsx)(B.a,{children:"Undo"});n(e).then((function(){return t("'".concat(e.alias,"' deleted"),{action:c})})).catch((function(){return t("Problem deleting '".concat(e.alias,"'"),{variant:"error"})}))}),[n,e,t])}var Pe=function(e){var t=e.go,n=e.onClose,c=Object(G.a)(e,["go","onClose"]),a=Object(je.b)().enqueueSnackbar,r=function(){var e=$(),t=Object(X.useQueryClient)();return Object(X.useMutation)((function(t){var n=t.current,c=t.updated;return e.then((function(e){return e.patchGo(n.id,ae()(n,c))}))}),{onSuccess:function(e,n){var c=n.alias;t.invalidateQueries([ee]),t.invalidateQueries([te,c])}})}().mutateAsync,i=Se({onSubmit:Object(S.useCallback)((function(e,c){var i=c.setSubmitting;r({current:t,updated:ae()(t,e)}).catch((function(){return a("Problem editing '".concat(e.alias,"'"),{variant:"error"})})).finally((function(){i(!1),n()}))}),[r,t,a,n]),initialValues:t});return Object(y.jsx)(ve,Object(j.a)(Object(j.a)({title:"Edit ".concat(t.alias),action:"Edit",onClose:n,onSubmit:i.handleSubmit},c),{},{children:Object(y.jsx)(ge,{formik:i})}))};var we=function(e){var t=Object.assign({},e),n=_e(),c=Object(b.a)(n,1)[0];return Object(y.jsx)(h.a,Object(j.a)(Object(j.a)({position:"static",sx:{bgcolor:"primary.dark"}},t),{},{children:Object(y.jsxs)(f.a,{children:[Object(y.jsx)(l.a,{width:.25,minWidth:140,children:Object(y.jsx)(x.a,{variant:"h6",color:"inherit",children:"Yougo"})}),Object(y.jsx)(l.a,{flexGrow:1,marginX:1,children:Object(y.jsx)(E,{cancelOnEscape:!0})}),Object(y.jsxs)(l.a,{width:.25,minWidth:140,display:"flex",justifyContent:"flex-end",children:[Object(y.jsx)(v.a,{onClick:c,color:"inherit",size:"large",children:Object(y.jsx)(O.a,{})}),Object(y.jsx)(z,{})]})]})}))},Te=function(e){var t=e.children;return Object(y.jsxs)(s.a,{minHeight:"100vh",spacing:2,alignItems:"center",children:[Object(y.jsx)(l.a,{minWidth:1,children:Object(y.jsx)(we,{})}),Object(y.jsx)(u.a,{component:"main",sx:{flexGrow:1,minHeight:1},children:t}),Object(y.jsx)(l.a,{minWidth:1})]})};Te.defaultProps={};var Ee=Te,Re=n(222),Ie=function(e){var t=e.children,n=Object(G.a)(e,["children"]);return Object(y.jsx)(s.a,Object(j.a)(Object(j.a)({alignItems:"center",spacing:1,color:Re.a[500]},n),{},{children:t}))},Le=n(519),De=function(e){var t=Object.assign({},e);return Object(y.jsxs)(Ie,Object(j.a)(Object(j.a)({},t),{},{children:[Object(y.jsx)(l.a,{children:Object(y.jsx)(Le.a,{size:60,color:"inherit"})}),Object(y.jsx)(x.a,{variant:"h4",color:"text.primary",children:"Loading"}),Object(y.jsx)(x.a,{color:"text.secondary",children:"Please wait while we load your data"})]}))},Be=function(){var e=function(e,t){var n=$();return Object(X.useQuery)([te,e],(function(){return n.then((function(t){return t.findGoByIdOrAlias(e)}))}),t)}(Object(se.h)().go,{retry:!1,onSuccess:function(e){window.location.replace(e.href)}}),t=e.isLoading,n=e.isError,c=e.data;return n?Object(y.jsx)("span",{children:"Something went wrong!"}):t?Object(y.jsx)(De,{}):Object(y.jsxs)(Ie,{children:["You will be redirected to ",Object(y.jsx)("a",{href:c.href,children:c.href})," shortly..."]})},Ue=n(508),We=n(509),ze=n(492),Ge=function(e){var t=Object.assign({},e),n=_e(),c=Object(b.a)(n,1)[0];return Object(y.jsxs)(Ie,Object(j.a)(Object(j.a)({},t),{},{children:[Object(y.jsx)(ze.a,{sx:{fontSize:"h1.fontSize"}}),Object(y.jsx)(x.a,{variant:"h3",children:"You have no Gos!"}),Object(y.jsx)(x.a,{color:"text.secondary",children:"Why don't you add some? :)"}),Object(y.jsx)(B.a,{onClick:c,variant:"contained",color:"primary",children:"Add a Go"})]}))},He=n(236),Me=n.n(He),Qe=n(505),qe=n(494),Ye=n(520),Fe=n(235),Ve=n.n(Fe),Ke=n(233),Ne=n.n(Ke),Je=n(234),Ze=n.n(Je),$e=n(493),Xe=function(e){var t=e.go,n=e.onClose,c=Object(G.a)(e,["go","onClose"]),a=function(e){var t=Object(ke.b)((function(){return Object(y.jsx)(Pe,{go:e,onClose:a})})),n=Object(b.a)(t,2),c=n[0],a=n[1];return[c,a]}(t),r=Object(b.a)(a,1)[0],i=function(e){var t=Object(je.b)().enqueueSnackbar;return Object(S.useCallback)((function(){ue()(e.href)?t("URL copied"):t("Problem copying '".concat(e.alias,"' URL"),{variant:"error"})}),[e.href,e.alias,t])}(t),o=Ae(t),s=Object(S.useCallback)((function(){r(),n()}),[r,n]),l=Object(S.useCallback)((function(){i(),n()}),[i,n]),u=Object(S.useCallback)((function(){o(),n()}),[o,n]);return Object(y.jsxs)(L.a,Object(j.a)(Object(j.a)({MenuListProps:{dense:!0},onClose:n},c),{},{children:[Object(y.jsxs)(D.a,{onClick:s,children:[Object(y.jsx)($e.a,{children:Object(y.jsx)(Ne.a,{fontSize:"small"})}),Object(y.jsx)(qe.a,{children:"Edit"})]}),Object(y.jsxs)(D.a,{onClick:l,children:[Object(y.jsx)($e.a,{children:Object(y.jsx)(Ze.a,{fontSize:"small"})}),Object(y.jsx)(qe.a,{children:"Copy URL"})]}),Object(y.jsxs)(D.a,{onClick:u,children:[Object(y.jsx)($e.a,{children:Object(y.jsx)(Ve.a,{fontSize:"small"})}),Object(y.jsx)(qe.a,{children:"Delete"})]})]}))},et=function(e){var t=e.go,n=Object(G.a)(e,["go"]),c=Object(W.usePopupState)({variant:"popover"});return Object(y.jsxs)(Qe.a,Object(j.a)(Object(j.a)({button:!0},n),{},{children:[Object(y.jsx)(qe.a,{disableTypography:!0,primary:Object(y.jsx)(x.a,{variant:"subtitle1",children:t.alias}),secondary:Object(y.jsx)(x.a,{color:"text.secondary",fontSize:13,noWrap:!0,children:t.href})}),Object(y.jsxs)(Ye.a,{children:[Object(y.jsx)(v.a,Object(j.a)(Object(j.a)({},Object(W.bindTrigger)(c)),{},{size:"large",children:Object(y.jsx)(Me.a,{})})),Object(y.jsx)(Xe,Object(j.a)({go:t,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},Object(W.bindMenu)(c)))]})]}))},tt=function(e){var t=e.gos,n=Object(G.a)(e,["gos"]);return 0===t.length?Object(y.jsx)(Ge,{}):Object(y.jsx)(Ue.a,Object(j.a)(Object(j.a)({},n),{},{children:Object(y.jsx)(We.a,{dense:!0,children:t.map((function(e){return Object(y.jsx)(et,{go:e},e.id)}))})}))};tt.defaultProps={gos:[]};var nt=tt,ct=function(){var e=ne(P()),t=e.isLoading,n=e.data;return t?Object(y.jsx)(De,{}):Object(y.jsx)(nt,{gos:n})},at=function(e){var t=Object.assign({},e);return Object(y.jsxs)(Ie,Object(j.a)(Object(j.a)({},t),{},{children:[Object(y.jsx)(x.a,{variant:"h1",color:"text.primary",children:"Yougo"}),Object(y.jsx)(x.a,{color:"text.secondary",children:"Please sign in to use this site"})]}))},rt=function(){return function(){var e=Object(se.f)(),t=Object(c.b)(),n=t.loginWithRedirect,a=t.isAuthenticated,r=t.isLoading;Object(S.useEffect)((function(){(function(){var t=Object(oe.a)(ie.a.mark((function t(){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r||a){t.next=3;break}return t.next=3,n({appState:{returnTo:e}});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()().then()}),[a,r,e,n])}(),Object(y.jsx)(o,{fallback:Object(y.jsx)(at,{}),children:Object(y.jsx)(Ee,{children:Object(y.jsxs)(se.c,{children:[Object(y.jsx)(se.a,{path:"/",element:Object(y.jsx)(ct,{})}),Object(y.jsx)(se.a,{path:"/go/:go",element:Object(y.jsx)(Be,{})})]})})})},it=n(496),ot=n(501),st=function(e){var t=e.children,n=Object(se.g)();return Object(y.jsx)(c.a,{domain:V,clientId:K,redirectUri:N,audience:F,cacheLocation:"localstorage",useRefreshTokens:"true",onRedirectCallback:function(e){n((null===e||void 0===e?void 0:e.returnTo)||window.location.pathname,{replace:!0})},children:t})},lt=Object(S.memo)(st),ut=n(80),jt=new X.QueryClient({queries:{staleTime:J}}),bt=n(495),dt=n(78),Ot=n(238),ht=Object(Ot.a)({palette:{primary:{main:bt.a[700]},secondary:dt.a},components:{MuiSnackbar:{defaultProps:{autoHideDuration:4e3,anchorOrigin:{vertical:"bottom",horizontal:"left"}}}}}),ft=function(e){var t=e.children;return Object(y.jsx)(ut.a,{children:Object(y.jsx)(lt,{children:Object(y.jsx)(X.QueryClientProvider,{client:jt,children:Object(y.jsx)(A,{children:Object(y.jsx)(ot.a,{theme:ht,children:Object(y.jsx)(je.a,{maxSnack:3,children:Object(y.jsxs)(ke.a,{children:[Object(y.jsx)(it.a,{}),t]})})})})})})})},xt=n(38),vt=n.n(xt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));vt.a.render(Object(y.jsx)(S.StrictMode,{children:Object(y.jsx)(ft,{children:Object(y.jsx)(rt,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[443,1,2]]]);
//# sourceMappingURL=main.f0cd73d0.chunk.js.map